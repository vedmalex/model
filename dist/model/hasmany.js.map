{"version":3,"sources":["model/hasmany.js"],"names":["HasMany","props","children","result","ref","hasMany","obj","$obj","hasMany_","res","match","entity","field","trim","JSON","parse","stringify","toString","undefined"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;;;;;;;;;;;IAEaA,O,WAAAA,O;;;;;4BAEIC,K,EAAOC,Q,EAAU;AAC9B,UAAIC,sBACCF,KADD,CAAJ;AAGA,UAAIE,OAAOC,GAAP,IAAc,CAACD,OAAOE,OAA1B,EAAmC;AACjCF,eAAOE,OAAP,GAAiBF,OAAOC,GAAxB;AACA,eAAOD,OAAOC,GAAd;AACD;AACD,aAAOD,MAAP;AACD;;;AAED,mBAAYG,GAAZ,EAAiB;AAAA;;AAAA,6GACTA,GADS;AAEhB;;;;+BAUUA,G,EAAK;AACd,UAAIA,GAAJ,EAAS;AACP,qHAAiBA,GAAjB;;AAEA,YAAMH,SAAS,KAAKI,IAAL,gBAAgB,KAAKA,IAArB,IAA6B,EAA5C;;AAEA,YAAIC,WAAWF,IAAID,OAAnB;;AAEA,YAAIA,gBAAJ;AACA,YAAIG,QAAJ,EAAc;AACZH,oBAAU,cAAV;AACA,cAAII,MAAMD,SAASE,KAAT,0BAAV;AACAL,kBAAQM,MAAR,GAAiBF,IAAI,CAAJ,KAAUH,IAAIK,MAA/B;AACAN,kBAAQO,KAAR,GAAgBH,IAAI,CAAJ,IAAS,yBAAUA,IAAI,CAAJ,EAAOI,IAAP,EAAV,CAAT,GAAoC,EAApD;AACD;;AAEDV,eAAOK,QAAP,GAAkBA,QAAlB;AACAL,eAAOE,OAAP,GAAiBA,OAAjB;;AAEA,aAAKE,IAAL,gBACKJ,MADL;AAGD;AACF;AACD;;;;+BACW;AACT,UAAIF,QAAQ,KAAKM,IAAjB;AACA,UAAIE,gHAAJ;AACA,aAAOK,KAAKC,KAAL,CAAWD,KAAKE,SAAL,cACbP,GADa;AAEhBJ,iBAASJ,MAAMI,OAAN,GAAgBJ,MAAMI,OAAN,CAAcY,QAAd,EAAhB,GAA2CC;AAFpC,SAAX,CAAP;AAID;;AAED;;;;6BACS;AACP,UAAIjB,QAAQ,KAAKM,IAAjB;AACA,UAAIE,8GAAJ;AACA,aAAOK,KAAKC,KAAL,CAAWD,KAAKE,SAAL,cACbP,GADa;AAEhBJ,iBAASJ,MAAMO;AAFC,SAAX,CAAP;AAID;;;wBAlDa;AACZ,aAAO,KAAKD,IAAL,GAAY,KAAKA,IAAL,CAAUF,OAAtB,GAAgCa,SAAvC;AACD;;;wBAES;AACR,aAAO,KAAKX,IAAL,GAAY,KAAKA,IAAL,CAAUF,OAAtB,GAAgCa,SAAvC;AACD","file":"model/hasmany.js","sourcesContent":["import {RefBase} from './refbase';\nimport {REF_PATTERN} from './definitions';\nimport {Ref} from './ref';\nimport camelcase from 'camelcase';\n\nexport class HasMany extends RefBase {\n\n  static compose(props, children) {\n    let result = {\n      ...props,\n    };\n    if (result.ref && !result.hasMany) {\n      result.hasMany = result.ref;\n      delete result.ref;\n    }\n    return result;\n  }\n\n  constructor(obj) {\n    super(obj);\n  }\n\n  get hasMany() {\n    return this.$obj ? this.$obj.hasMany : undefined;\n  }\n\n  get ref() {\n    return this.$obj ? this.$obj.hasMany : undefined;\n  }\n\n  updateWith(obj) {\n    if (obj) {\n      super.updateWith(obj);\n\n      const result = this.$obj ? {...this.$obj} : {};\n\n      let hasMany_ = obj.hasMany;\n\n      let hasMany;\n      if (hasMany_) {\n        hasMany = new Ref();\n        let res = hasMany_.match(REF_PATTERN);\n        hasMany.entity = res[1] || obj.entity;\n        hasMany.field = res[2] ? camelcase(res[2].trim()) : '';\n      }\n\n      result.hasMany_ = hasMany_;\n      result.hasMany = hasMany;\n\n      this.$obj = {\n        ...result\n      };\n    }\n  }\n  // it get fixed object\n  toObject() {\n    let props = this.$obj;\n    let res = super.toObject();\n    return JSON.parse(JSON.stringify({\n      ...res,\n      hasMany: props.hasMany ? props.hasMany.toString() : undefined,\n    }));\n  }\n\n  // it get clean object with no default values\n  toJSON() {\n    var props = this.$obj;\n    let res = super.toJSON();\n    return JSON.parse(JSON.stringify({\n      ...res,\n      hasMany: props.hasMany_,\n    }));\n  }\n}\n"],"sourceRoot":"/source/"}